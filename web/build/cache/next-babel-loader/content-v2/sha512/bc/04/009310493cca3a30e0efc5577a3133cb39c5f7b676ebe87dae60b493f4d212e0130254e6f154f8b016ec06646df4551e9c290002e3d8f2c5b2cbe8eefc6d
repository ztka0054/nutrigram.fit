{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { useFormik, FieldArray, FormikProvider } from \"formik\";\nimport * as Yup from \"yup\";\nimport { map } from \"lodash\";\nimport useApp from \"../../../../../hooks/useApp\";\nimport TagLang from \"../../../../modules/GetTagLang\";\nimport MessageValidation from \"../../../../modules/Forms/MessageValidation\";\nimport request from \"../../../../../helper/core_services/core/requestService\";\nimport menu from \"../../../../../helper/core_services/endpoints/menu\";\nimport { sortByAttr } from \"../../../../../helper/array/sort\";\nimport SubMealsCont from \"../Forms/SubMealsCont\";\nexport default function FormMenu(_ref) {\n  var idElement = _ref.idElement;\n  var router = useRouter();\n\n  var _useApp = useApp(),\n      locale = _useApp.locale;\n\n  var _useState = useState(null),\n      elementsMeals = _useState[0],\n      setElementsMeals = _useState[1];\n\n  var formik = useFormik({\n    validateOnChange: false,\n    initialValues: initialValues(),\n    validationSchema: Yup.object(validationSchema()),\n    onSubmit: function () {\n      var _onSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData, _ref2) {\n        var resetForm;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                resetForm = _ref2.resetForm;\n                if (!(formData !== null && formData !== void 0 && formData.id)) SaveMenu(formData);else UpdateMenu(formData); // SendForm(formData, resetForm);\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function onSubmit(_x, _x2) {\n        return _onSubmit.apply(this, arguments);\n      }\n\n      return onSubmit;\n    }()\n  });\n  useEffect(function () {\n    GetMeals();\n  }, [idElement]);\n  useEffect(function () {\n    if (idElement && elementsMeals) GetData();\n  }, [elementsMeals]);\n\n  var GetData = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var req;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return request(menu.get_menu, null, [idElement], {\n                locale: locale\n              });\n\n            case 2:\n              req = _context2.sent;\n              if (req != null) DrawGetData(req);\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function GetData() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var DrawGetData = function DrawGetData(info) {\n    var mealTypes = map(elementsMeals, function (element) {\n      var _ref4;\n\n      var find = info.mealTypeMenus.find(function (obj) {\n        return obj.mealType.id === element.mealType;\n      });\n      if (find != undefined) return _ref4 = {\n        mealType: find.mealType.id,\n        name: find.mealType.name,\n        monday: find.monday,\n        tuesday: find.tuesday\n      }, _defineProperty(_ref4, \"tuesday\", find.tuesday), _defineProperty(_ref4, \"wednesday\", find.wednesday), _defineProperty(_ref4, \"thursday\", find.thursday), _defineProperty(_ref4, \"friday\", find.friday), _defineProperty(_ref4, \"saturday\", find.saturday), _defineProperty(_ref4, \"sunday\", find.sunday), _ref4;else return _objectSpread({}, element);\n    });\n    var values = {\n      id: info.id,\n      name: info.name,\n      mealTypes: mealTypes\n    };\n    formik.setValues(values);\n  };\n\n  var GetMeals = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var req;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return request(menu.get_meals_type, null, null, {\n                locale: locale\n              });\n\n            case 2:\n              req = _context3.sent;\n              if (req != null) DrawMeals(req);\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function GetMeals() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var DrawMeals = function DrawMeals(info) {\n    sortByAttr();\n    info = info.sortBy(\"order\");\n    var mealTypes = map(info, function (element, index) {\n      var _ref6;\n\n      return _ref6 = {\n        mealType: element.id,\n        name: element.name,\n        monday: null,\n        tuesday: null\n      }, _defineProperty(_ref6, \"tuesday\", null), _defineProperty(_ref6, \"wednesday\", null), _defineProperty(_ref6, \"thursday\", null), _defineProperty(_ref6, \"friday\", null), _defineProperty(_ref6, \"saturday\", null), _defineProperty(_ref6, \"sunday\", null), _ref6; // arrayHelpers.push({ mealType: element.id, ...element, ...week });\n    });\n    var values = {\n      name: \"\",\n      mealTypes: mealTypes\n    };\n    formik.setValues(values);\n    setElementsMeals(mealTypes);\n  };\n\n  var SaveMenu = /*#__PURE__*/function () {\n    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(formData) {\n      var req;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return request(menu.post_new_menu, formData, null, {\n                locale: locale\n              });\n\n            case 2:\n              req = _context4.sent;\n              if (req != null) router.push(\"/dashboard/menus\");\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function SaveMenu(_x3) {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var UpdateMenu = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(formData) {\n      var req;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return request(menu.put_edit_menu, formData, [formData.id], {\n                locale: locale\n              });\n\n            case 2:\n              req = _context5.sent;\n              if (req != null) router.push(\"/dashboard/menus\");\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function UpdateMenu(_x4) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsx(\"form\", {\n    onSubmit: formik.handleSubmit,\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"col-12\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"sty-cont-input-2\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"sty-tag\",\n            children: /*#__PURE__*/_jsx(TagLang, {\n              group: \"input\",\n              tag: \"name\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"sty-input\",\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              name: \"name\",\n              value: formik.values.name,\n              onChange: formik.handleChange,\n              type: \"text\"\n            }), /*#__PURE__*/_jsx(MessageValidation, {\n              error: formik.errors.name\n            })]\n          })]\n        })\n      }), /*#__PURE__*/_jsx(FormikProvider, {\n        value: formik,\n        children: /*#__PURE__*/_jsx(FieldArray, {\n          name: \"mealTypes\",\n          render: function render(arrayHelpers) {\n            return /*#__PURE__*/_jsx(SubMealsCont, {\n              formik: formik,\n              arrayHelpers: arrayHelpers,\n              father: \"mealTypes\"\n            });\n          }\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"col-12 text-center sty-magin-b-1\",\n        children: /*#__PURE__*/_jsxs(\"button\", {\n          className: \"sty-button-dash-1\",\n          type: \"submit\",\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: \"sty-icon\",\n            children: /*#__PURE__*/_jsx(\"img\", {\n              src: \"/static/img/favicons/app/save_w.svg\"\n            })\n          }), /*#__PURE__*/_jsx(\"div\", {\n            className: \"sty-tag\",\n            children: /*#__PURE__*/_jsx(TagLang, {\n              group: \"button\",\n              tag: \"save\"\n            })\n          })]\n        })\n      })]\n    })\n  });\n}\n\nfunction initialValues() {\n  return {\n    name: \"\"\n  };\n}\n\nfunction validationSchema() {\n  return {\n    name: Yup.string().required(\"required\")\n  };\n}","map":null,"metadata":{},"sourceType":"module"}