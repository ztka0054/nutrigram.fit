{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport { useRouter } from \"next/router\";\nimport { useFormik, FieldArray, FormikProvider } from \"formik\";\nimport * as Yup from \"yup\";\nimport { map, size } from \"lodash\";\nimport moment from \"moment\";\nimport useApp from \"../../../../../../../../hooks/useApp\";\nimport TagLang from \"../../../../../../../modules/GetTagLang\";\nimport request from \"../../../../../../../../helper/core_services/core/requestService\";\nimport hydratation from \"../../../../../../../../helper/core_services/endpoints/hydration\";\nimport { message_1 } from \"../../../../../../../../helper/appearance/messages\";\nimport GetLanguage from \"../../../../../../../../helper/i18n/getValueTagLang\";\nimport SubFormQuestions from \"./FormContHydratation\";\nexport default function FormHydratation(_ref) {\n  var ShowData = _ref.ShowData;\n\n  var _useRouter = useRouter(),\n      query = _useRouter.query;\n\n  var _useApp = useApp(),\n      locale = _useApp.locale;\n\n  var _useState = useState([]),\n      dataUpdate = _useState[0],\n      setDataUpdate = _useState[1];\n\n  var formik = useFormik({\n    validateOnChange: false,\n    initialValues: initialValues(),\n    validationSchema: Yup.object(validationSchema()),\n    onSubmit: function () {\n      var _onSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData, _ref2) {\n        var resetForm;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                resetForm = _ref2.resetForm;\n                SendNewForm(formData, resetForm);\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function onSubmit(_x, _x2) {\n        return _onSubmit.apply(this, arguments);\n      }\n\n      return onSubmit;\n    }()\n  });\n  useEffect(function () {\n    GetDataHydratation();\n  }, []);\n\n  var GetDataHydratation = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var req, hydrations;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return request(hydratation.get_hydratation, null, [query.id], locale);\n\n            case 2:\n              req = _context2.sent;\n\n              if (req != null) {\n                hydrations = map(req, function (element) {\n                  var values = _objectSpread({}, element);\n\n                  values.fromTime = moment(\"2020-01-01T\".concat(values.fromTime)).toDate();\n                  values.toTime = moment(\"2020-01-01T\".concat(values.toTime)).toDate();\n                  return values;\n                });\n                formik.setValues({\n                  hydrations: hydrations\n                });\n                setDataUpdate(hydrations);\n              }\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function GetDataHydratation() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var SendNewForm = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(formData) {\n      var arrayRequest;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              arrayRequest = [];\n              map(dataUpdate, function (element) {\n                var find = formData.hydrations.find(function (obj) {\n                  return obj.id === element.id;\n                });\n                if (find == undefined) arrayRequest.push(request(hydratation.delete_hydratation, null, [query.id, element.id], {\n                  locale: locale\n                }));\n              });\n              map(formData.hydrations, function (element) {\n                var params = _objectSpread({}, element);\n\n                params.fromTime = moment(params.fromTime).format(\"HH:mm:ss\");\n                params.toTime = moment(params.toTime).format(\"HH:mm:ss\");\n                if (!(params !== null && params !== void 0 && params.id)) arrayRequest.push(request(hydratation.post_hydratation, params, [query.id], {\n                  locale: locale\n                }));\n                if (params !== null && params !== void 0 && params.id) arrayRequest.push(request(hydratation.patch_hydratation, params, [query.id, params === null || params === void 0 ? void 0 : params.id], {\n                  locale: locale\n                }));\n              });\n              _context3.next = 5;\n              return Promise.all(arrayRequest);\n\n            case 5:\n              ShowData();\n              message_1(GetLanguage(\"validation\", \"message_1\"));\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function SendNewForm(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsx(\"form\", {\n    onSubmit: formik.handleSubmit,\n    children: /*#__PURE__*/_jsx(FormikProvider, {\n      value: formik,\n      children: /*#__PURE__*/_jsx(FieldArray, {\n        name: \"hydrations\",\n        render: function render(arrayHelpers) {\n          return /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"row\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \"col-12\",\n                children: /*#__PURE__*/_jsx(SubFormQuestions, {\n                  formik: formik,\n                  arrayHelpers: arrayHelpers,\n                  father: \"hydrations\"\n                })\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"text-right\",\n              children: /*#__PURE__*/_jsxs(\"button\", {\n                className: \"sty-button-dash-1 color-3\",\n                type: \"button\",\n                onClick: function onClick() {\n                  return arrayHelpers.push({});\n                },\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"sty-icon\",\n                  children: /*#__PURE__*/_jsx(\"img\", {\n                    src: \"/static/img/favicons/app/add_w.svg\"\n                  })\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"sty-tag\",\n                  children: /*#__PURE__*/_jsx(TagLang, {\n                    group: \"button\",\n                    tag: \"add\"\n                  })\n                })]\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"col-12 text-center sty-magin-b-1\",\n              children: /*#__PURE__*/_jsxs(\"button\", {\n                className: \"sty-button-dash-1\",\n                type: \"submit\",\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"sty-icon\",\n                  children: /*#__PURE__*/_jsx(\"img\", {\n                    src: \"/static/img/favicons/app/save_w.svg\"\n                  })\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"sty-tag\",\n                  children: /*#__PURE__*/_jsx(TagLang, {\n                    group: \"button\",\n                    tag: \"save\"\n                  })\n                })]\n              })\n            })]\n          });\n        }\n      })\n    })\n  });\n}\n\nfunction initialValues() {\n  return {// image_check: \"\",\n  };\n}\n\nfunction validationSchema() {\n  return {// image_check: Yup.string().required(\"required\"),\n  };\n}","map":null,"metadata":{},"sourceType":"module"}